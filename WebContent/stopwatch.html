<!DOCTYPE html>
<html>
<head>
	<meta charset="ISO-8859-1">
	<title>Clock</title>
	<link rel="stylesheet" type="text/css" href="clock.css"></link>
	<script src="utils.js"></script>
	<style>
		 input[type="button"]{
		 	padding:2px;
		 }
		 
		 ul {
		 	text-align:center;
		 	list-style-type:none;
		 	font-size:20px;
		 }
		 
		 ul li{
		 	margin:5px;
		 }
	</style>
</head>

<body>
	<header>
		<div id="nav-bar">
			<a href="local_clock.html">Local Time</a>
			<a href="countdown.html">Countdown</a>
			<a href="stopwatch.html">Stopwatch</a>
		</div>
	</header>
	<script src="navbar.js"></script>
	<div class="container">
		<div id="timer-box">
			<label id="time">00:00:00</label>
			<ul id="laps"></ul>
			<div id="button-box" style="width:70%;">
				<input onclick="startTimer()" id="start-timer" style="width:20%; float:left" type="button" value="Start">
				<input onclick="stopTimer()" id="stop-timer" style="width:20%; margin-left: 6.5%" type="button" value="Stop">
				<input onclick="clearTimer()" id="clear-timer" style="width:20%; margin-left: 5.5%" type="button" value="Clear">
				<input onclick="lap()" id="lap" style="width:20%; float:right" type="button" value="Lap">
			</div>
		</div>
	</div>
	<script>
		//TODO: If the user clicks the same navigation button, dont refresh the page.
		//Improvement: User one button for starting and stopping
		var stopwatch;
		var milliseconds = 0, seconds = 0, minutes = 0;
		var isRunning = false;
		
		var timeLabel = document.getElementById("time");
		
		function elapsed(){
			if (milliseconds >= 9){
				milliseconds = 0;
				seconds ++;
			}
			if (seconds > 59){
				seconds = 0;
				minutes++;
			} else {
				milliseconds++;
			}

			timeLabel.innerText = formattedTime();
		}
		
		function startTimer(){
			if (!isRunning){
				stopwatch = setInterval(elapsed, 100);
				isRunning = true;
			}
		}
		
		function stopTimer(){
			clearInterval(stopwatch);
			stopwatch = null;
			isRunning = false;
		}
		
		function clearTimer(){
			stopTimer();
			milliseconds = seconds = minutes = 0;
			timeLabel.innerText = '00:00:00';
		}
		
		function lap(){
			if (stopwatch == null) //For now
				return;
			
			var lapList = document.querySelector("ul");
			var textNode = document.createTextNode("Lap: " + formattedTime());
			var lap = document.createElement("li");
			lap.appendChild(textNode);
			lapList.appendChild(lap);
		}
		
		function formattedTime(){
			var mins_f = formatNumber(minutes);
			var secs_f = formatNumber(seconds);
			var milli_f = formatNumber(milliseconds);
			return `${mins_f}:${secs_f}:${milli_f}`;
		}
	</script>
</body>
</html>